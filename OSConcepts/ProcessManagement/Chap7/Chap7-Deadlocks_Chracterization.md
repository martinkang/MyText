# 교착상태의 특징


## 필요조건들
* 교착상태는 한 시스템에 다음 네 가지 조건이 동시에 성립될 때 발생할 수 있다.
	1. 상호 배제
		- 최소한 하나의 자원이 비공유 모드로 점유되어야 한다.
		- 비공유 모드에서는 한 번에 한 프로세스만이 그 자원을 사용할 수 있다.
		- 다른 프로세스가 그 자원을 요청하면, 요청 프로세스는 자원이 방출될 때까지 반드시 지연되어야 한다.
	2. 점유하며 대기
		- 프로세스는 최소한 하나의 자원을 점유한 채, 현재 다른 프로세스에 의해 점유된 자원을 추가로 얻기 위해
		반드시 대기해야 한다.
	3. 비선점
		- 자원들은 선점될 수 없어야 한다.
		- 즉 점유하고 있는 프로세스가 태스크를 종료한 후 그 프로세스에 의해 자발적으로만 방출될 수 있다.
	4. 순환대기
		- 대기하고 있는 프로세스의 집합 { P0, P1 ... Pn } 에서 P0 는 P1 이 점유한 자원을 대기하고,
		P1 은 P2 가 점유한 자원을, Pn 은 P0 가 점유한 자원을 대기한다.


## 자원할당 그래프
* 교착상태는 시스템 자원 할당 그래프라고 하는 방향 그래프로 보다 정확하게 기술할 수 있다.
	- 이 그래프는 정점 V 의 집합과 간선 E 의 집합으로 구성된다.
	- 정점 V 의 집합은 두 가지 타입으로 구별된다.
		- 프로세스 집합 P = { P1, P2, ... Pn }
		- 자원 집합 R = { R1, R2, ... Rn }
	- 간선
		- 프로세스 Pi 로부터 자원 Rj 로의 방향 간선은 Pi -> Rj 로 표현하며,
		이것은 프로세스 Pi 가 자원 Rj 의 인스턴스를 하나 요청하는 것으로 현재 이 자원을 기다리는 상태
			- 요청 간선
		- 자원 Ri 에서 Rj 로의 간선은 Ri -> Pj 로 표현하며,
		이것은 자원 Ri 의 한 인스턴스가 프로세스 Pj 에 할당된 것을 의미.
			- 할당 간선
	- 각 프로세스 Pi 를 원으로 표시
	- 각 자원 Ri 는 사각형으로 표시
		- 자원 타입에 인스턴스는 하나의 점으로 표시.
* 자원 할당 그래프의 정의로부터 그래프가 사이클을 포함하지 않으면 시스템내 어느 프로세스도 교착상태가 아니다.
	- 반면, 그래프가 사이클을 포함하면 교착상태를 포함할 수도 있다.
	- 각 자원 타입이 정확하게 하나의 인스턴스만을 가지면, 하나의 사이클은 교착 상태가 발생


#### 자원할당 그래프
![img1]( https://github.com/martinkang/Study/blob/master/OSConcepts/ProcessManagement/img/chap7-resource.png )


#### 교착상태를 갖는 자원 할당 그래프
![img2]( https://github.com/martinkang/Study/blob/master/OSConcepts/ProcessManagement/img/chap7-resource2.png )
* 간선
	- P1 -> R1 -> P2 -> R3 -> P3 -> R2 -> P1
	- P2 -> R3 -> P3 -> R2 -> P2
* 프로세스 P1, P2, 그리고 P3 는 교착상태.


#### 사이클이 있으면서 교착상태가 아닌 자원 할당 그래프
![img3](https://github.com/martinkang/Study/blob/master/OSConcepts/ProcessManagement/img/chap7-resource3.png )
* 간선
	- P1 -> R1 -> P3 -> R2 -> P1
* 교착상태가 아니다.
	- P4 는 R2 의 인스턴스를 방출할 수 있고, 이어 그 자원이 P3 에 할당될 수 있다.
		- 사이클이 없어진다.
